"use strict";(self["webpackChunkdesktop_wallet"]=self["webpackChunkdesktop_wallet"]||[]).push([[7349],{87349:function(e,t,o){o.r(t),o.d(t,{default:function(){return p}});var n=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"flex flex-col px-14 relative token-details-view"},[t("top-bar",{staticClass:"-mx-14",attrs:{title:e.token.name},scopedSlots:e._u([{key:"action",fn:function(){return[t("button",{attrs:{type:"button"},on:{click:e.removeCustomToken}},[t("i",{staticClass:"font-normal icon-delete text-brand-primary"})])]},proxy:!0}])}),t("token-form",{staticClass:"flex-grow",attrs:{"token-data":e.token},on:{tokenFormCancelled:e.back,tokenFormConfirmed:e.tokenUpdateConfirmed}}),t("multi-purpose-popup",{ref:"tokenPopup"})],1)},r=[],s=o(42514),i=o(62989),a=o(69986),l=o(20144),c=o(25108),u=l.ZP.extend({name:"TokenDetails",components:{MultiPurposePopup:s.Z,TokenForm:i.Z,TopBar:a.Z},computed:{token(){return this.$route.params.token},tokenPopup(){return this.$refs.tokenPopup}},methods:{back(){this.$router.back()},removeCustomToken(){const{name:e}=this.token,t=this.tokenPopup;t.show({cancelButtonTitle:this.$t("general.cancel"),description:this.$t("views.networksView.deleteTokenPopupDescription",{tokenName:e}),title:this.$t("views.networksView.deleteTokenPopupTitle")}),t.$once("popupConfirmed",this.removeCustomTokenConfirmed)},async removeCustomTokenConfirmed(){const{address:e,chain:t,name:o}=this.token,n=o,r=this.tokenPopup;this.showLoader(),await this.$store.dispatch("removeCustomToken",{address:e,chain:t}).then((()=>{this.showSuccess(),r.$once("popupConfirmed",this.back)})).catch((t=>{c.error(`Error during custom token ${n} remove: ${t}`),this.$errorReporter.reportError(t,{extraData:{tokenAddress:e,tokenName:n}}),this.showError()}))},showError(e){const t=this.tokenPopup;t.show({description:e||this.$t("errors.generic.somethingWentWrong"),popupType:"error"})},showLoader(){const e=this.tokenPopup;e.show({description:this.$t("components.popovers.savingChanges"),popupType:"loader"})},showSuccess(){const e=this.tokenPopup;e.show({popupType:"success",title:this.$t("general.success")})},async tokenUpdateConfirmed(e){this.showLoader(),await this.$store.dispatch("updateCustomToken",e).then((e=>{e&&this.showSuccess()})).catch((t=>{c.error(`Error during custom chain update ${e.name}: ${t}`),this.$errorReporter.reportError(t,{extraData:{tokenName:e.name}}),this.showError()}))}}}),m=u,d=o(1001),h=(0,d.Z)(m,n,r,!1,null,null,null),p=h.exports},62989:function(e,t,o){o.d(t,{Z:function(){return w}});var n=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"flex flex-col token-form"},[e.tokenCreateMode?[t("div",{staticClass:"font-medium mb-4 text-base text-white"},[e._v(" "+e._s(e.$t("general.network"))+" ")]),t("network-selector",{staticClass:"mb-8 relative",attrs:{"networks-list":e.customNetworks},model:{value:e.token.chain,callback:function(t){e.$set(e.token,"chain",t)},expression:"token.chain"}}),t("opera-input",e._b({staticClass:"mb-8",attrs:{label:e.$t("general.tokenName"),name:"name",placeholder:e.$t("general.tokenName")},on:{input:e.validate},model:{value:e.token.name,callback:function(t){e.$set(e.token,"name","string"===typeof t?t.trim():t)},expression:"token.name"}},"opera-input",{...e.showError("name")},!1))]:e._e(),e._l(e.formFieldsConfig,(function(o){return t("opera-input",e._b({key:`token-form-field-${o.name}`,staticClass:"mb-8",attrs:{label:o.label,name:o.name,placeholder:o.label},on:{input:e.validate},model:{value:e.token[o.name],callback:function(t){e.$set(e.token,o.name,t)},expression:"token[field.name]"}},"opera-input",{...e.showError(o.name)},!1))})),t("div",{staticClass:"flex-grow"}),t("div",{staticClass:"flex justify-between mb-10"},[t("outlined-button",{staticClass:"w-44",attrs:{title:e.$t("general.cancel")},on:{click:e.tokenFormCancelled}}),t("primary-button",{staticClass:"w-44",attrs:{disabled:e.formInvalid,title:e.$t("general."+(e.tokenCreateMode?"add":"save"))},on:{click:e.tokenFormConfirmed}})],1)],2)},r=[],s=o(81719),i=o(79317),a=o(70794),l=o(30960),c=o(14957),u=o(13891),m=o(25319),d=o(20144),h=d.ZP.extend({name:"TokenForm",components:{NetworkSelector:l.Z,OperaInput:c.Z,OutlinedButton:u.Z,PrimaryButton:m.Z},props:{tokenData:{default:null,type:Object}},data(){const[e]=this.$store.getters.customNetworks;return{error:{},formInvalid:!1,showDeleteConfirmationPopup:!1,token:{address:"",chain:e.chain,decimals:null,name:"",symbol:""}}},computed:{chain(){const{chain:e}=this.$route.query;return e?JSON.parse(e):null},customNetworks(){return this.$store.getters.customNetworks},formFieldsConfig(){return[{label:this.$t("general.contractAddress"),name:"address"},{label:this.$t("general.symbol"),name:"symbol"},{label:this.$t("general.decimal"),name:"decimals"}]},tokenCreateMode(){return!this.tokenData},tokenFormFields(){return this.$children.filter((e=>e.$options._componentTag?.includes("opera-input")))}},watch:{error:{deep:!0,handler(e){this.formInvalid=!!Object.values(e).length}}},mounted(){if(this.tokenData)for(const e in this.tokenData)this.token[e]=this.tokenData[e];this.chain&&(this.token.chain=this.chain)},methods:{showError(e){return e in this.error?{error:this.error[e],icon:"icon-error"}:null},tokenFormCancelled(){this.$emit("tokenFormCancelled")},tokenFormConfirmed(){if(this.validateAll()){const{token:e}=this,t={address:e.address,chain:e.chain,decimals:new a.Z(e.decimals).toNumber(),name:e.name,symbol:e.symbol,type:i.iv.FUNGIBLE};this.$emit("tokenFormConfirmed",t)}},validate(e,t){const{target:o}=t,{name:n}=o;let r={...this.error};const s=this.validator(n,e);s.fieldIsValid?delete r[n]:r=Object.assign({},r,{[n]:s.message}),this.error=r},validateAll(){const e={},t=this.tokenFormFields;return t.forEach((({name:t,value:o})=>{const n=this.validator(t,o);n.fieldIsValid||(e[t]=n.message)})),this.error=e,!Object.entries(this.error).length},validator(e,t){let o,n=!0;switch(e){case"name":n=!!t,o=this.$t("errors.generic.incorrectField",{fieldName:this.$t("general.tokenName")});break;case"address":n=s.Ze(t),o=this.$t("errors.generic.incorrectField",{fieldName:this.$t("general.contract")});break;case"symbol":n=s.HA(t),o=this.$t("errors.generic.incorrectField",{fieldName:this.$t("general.symbol")});break;case"decimals":n=s.xP(t),o=this.$t("errors.generic.incorrectField",{fieldName:this.$t("general.decimal")});break;default:n=!0,o=""}return{fieldIsValid:n,message:o}}}}),p=h,k=o(1001),f=(0,k.Z)(p,n,r,!1,null,null,null),w=f.exports},81719:function(e,t,o){o.d(t,{Ff:function(){return h},HA:function(){return d},JW:function(){return u},Ze:function(){return m},wC:function(){return c},xP:function(){return a}});var n=o(70794),r=o(38531),s=o.n(r);function i(e){return(0,n.Z)(e)}function a(e){return i(e).isPositive()}function l(e){return/^(https?):\/\/.+$/.test(e)}function c(e){return/^(|wss?):\/\/.+$/.test(e)||l(e)}function u(e){const t=i(e);return t.isInteger()&&t.isPositive()}function m(e){return s().validate(e,"ETH")}function d(e){return/^[a-zA-Z]+$/.test(e)}function h(e){return l(e)}}}]);