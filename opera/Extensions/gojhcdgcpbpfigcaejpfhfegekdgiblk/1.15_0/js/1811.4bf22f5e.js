"use strict";(self["webpackChunkdesktop_wallet"]=self["webpackChunkdesktop_wallet"]||[]).push([[1811],{71811:function(t,e,r){r.r(e),r.d(e,{default:function(){return g}});var s=function(){var t=this,e=t._self._c;return e("div",[e("top-bar",{attrs:{"test-parent-name":"approve_confirm",title:t.$t("general.confirmation")}}),e("div",{staticClass:"px-4 py-4"},[e("div",{staticClass:"flex flex-col items-center justify-center mx-10"},[e("div",{staticClass:"flex flex-row items-center justify-center"},[e("token-icon",{staticClass:"h-10 my-2 w-10",attrs:{address:t.toAddress,chain:t.chain,"icon-uri":t.token.token.iconURI}})],1),e("div",{staticClass:"flex flex-col items-center justify-center"},[e("div",{staticClass:"font-bold py-4 text-2xl text-center"},[e("i18n",{attrs:{path:"views.approveConfirm.allowToSpend",tag:"p"},scopedSlots:t._u([{key:"symbol",fn:function(){return[e("span",[t._v(t._s(t.symbol))])]},proxy:!0},{key:"swapProvider",fn:function(){return[e("span",[t._v(t._s(t.swapProvider))])]},proxy:!0}])})],1),e("div",{staticClass:"py-4"},[e("i18n",{attrs:{path:"views.approveConfirm.allowToWithdraw",tag:"p"},scopedSlots:t._u([{key:"symbol",fn:function(){return[e("span",[t._v(t._s(t.symbol))])]},proxy:!0},{key:"swapProviderLink",fn:function(){return[e("span",[t._v(t._s(t.swapProvider))])]},proxy:!0}])})],1)]),e("div",{staticClass:"bg-brand-primary border-b border-opacity-10 w-full"}),e("div",{staticClass:"flex items-center py-4 w-full"},[t._m(0),t.tx&&null!==t.fee?e("div",{staticClass:"ms-4 w-full"},[e("div",{staticClass:"font-bold mb-1"},[t._v(t._s(t.$t("general.transactionFee")))]),e("div",{staticClass:"text-sm",class:[{"text-spectrum-red":t.insufficientFunds}]},[t._v(" "+t._s(t.transactionFee)+" ")])]):t._e()]),t.isFeeZero?e("div",{staticClass:"text-spectrum-red"},[t._v(" "+t._s(t.$t("errors.cannotEstimateGas"))+" ")]):t._e(),t.error?e("div",{staticClass:"flex justify-center my-5 text-center text-sm text-spectrum-red"},[e("img",{staticClass:"mx-2",attrs:{alt:"",src:r(98498)}}),e("span",[t._v(t._s(t.error))])]):t._e(),e("div",{staticClass:"flex gap-4 justify-around w-full"},[e("outlined-button",{staticClass:"mt-8 t-approve_confirm-reject w-1/2",attrs:{disabled:t.loading,loading:t.loading,title:t.$t("general.reject")},on:{click:t.back}}),e("primary-button",{staticClass:"mt-8 t-approve_confirm-approve w-1/2",attrs:{disabled:t.loading||!t.tx||!!t.error,loading:t.loading,title:t.$t("general.approve")},on:{click:t.approveTx}})],1)])])],1)},i=[function(){var t=this,e=t._self._c;return e("span",{staticClass:"icon-wrapper text-brand-primary"},[e("i",{staticClass:"icon-currency info-icon",staticStyle:{"font-size":"32px"}})])}],a=r(66229),n=r(70794),o=r(13891),c=r(25319),l=r(92266),u=r(69986),p=r(10359),d=r(37426),h=r(25108),f={name:"ApproveConfirm",components:{OutlinedButton:o.Z,PrimaryButton:c.Z,TokenIcon:l.Z,TopBar:u.Z},props:{approve:{default:void 0,type:Object},contract:{default:void 0,type:Object},token:{default:void 0,type:Object}},data(){return{error:null,fee:null,loading:!1,success:!1,tx:null}},computed:{chain(){return this.token.token.chain},contractName(){return this.contract.name},feeFiat(){if(!this.fee)return;const t=this.$store.getters.matchingNativeToken("",this.chain),e=this.getPriceForToken(t);return this.formatNumber(this.fee).multipliedBy(new n.Z(e))},feeSymbol(){const t=this.$store.getters.matchingNativeToken("",this.chain);return t?t.contract.symbol.toUpperCase():""},insufficientFunds(){return this.$store.getters.txError.insufficientFunds},isFeeZero(){if(null!==this.fee)return this.fee.isEqualTo(0)},swapProvider(){return this.$store.getters.aggregatorName},symbol(){return this.token.token.symbol},toAddress(){return this.approve.to},transactionFee(){if(!this.tx)return;const[t,e]=[this.formatNumber(this.fee),this.localizeCurrency(this.feeFiat)];return`~ ${t} ${this.feeSymbol} (${e})`}},watch:{insufficientFunds(t){t&&(this.error=this.$t("errors.generic.insufficientFunds"))}},async mounted(){await this.setupTx(),this.setSwapTxFee()},methods:{async approveTx(){this.loading=!0;try{const t=await this.$wallet.confirmTransaction(this.tx.txId);await this.$store.dispatch("setPendingApproval",Object.assign({timeStamp:Date.now(),token:this.token.token,txHash:t})),this.back()}catch(t){this.$store.getters.authAborted||(this.error=this.getErrorMessage(t),this.$errorReporter.reportError(t))}this.loading=!1},back(){this.$router.back()},formatNumber:p.Z.formatNumber,getErrorMessage(t){h.error(t),this.error=this.$t("errors.generic.unknownError")},getPriceForToken(t){return t?this.$store.getters.getPriceForToken(t):0},isTransactionFeeCovered(t){const{symbol:e}=this,r={amount:this.approve.value,chain:this.chain,fee:t,symbol:e};return this.$store.getters.isTransactionFeeCovered(r)},localizeCurrency:p.Z.localizeCurrency,setSwapTxFee(){const t=this.tx.token;this.fee=d.Z.withDecimals(t.amount,t.decimals),this.isTransactionFeeCovered(this.fee)||this.$store.dispatch("setTxError","insufficientFunds")},async setupTx(){this.loading=!0;try{const t=this.approve,e=(0,a.wL)(t);this.tx=await this.$wallet.createSwapTransaction(e)}catch(t){this.error=this.getErrorMessage(t),this.$errorReporter.reportError(t)}this.loading=!1}}},m=f,v=r(1001),y=(0,v.Z)(m,s,i,!1,null,null,null),g=y.exports}}]);