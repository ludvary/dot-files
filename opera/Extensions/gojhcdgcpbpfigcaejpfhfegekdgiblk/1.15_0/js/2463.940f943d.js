"use strict";(self["webpackChunkdesktop_wallet"]=self["webpackChunkdesktop_wallet"]||[]).push([[2463],{93091:function(t,e,a){a.d(e,{Z:function(){return p}});var r=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("footer",{staticClass:"w-full",class:[t.textColor,t.textSize]},[e("i18n",{attrs:{path:"termsOfService.operaWalletByBlueboard",tag:"p"},scopedSlots:t._u([{key:"blueboardTermsOfService",fn:function(){return[e("a",{staticClass:"t-tos_footer-tos_link text-brand-primary",on:{click:function(e){return t.$platform.createNewTab({url:"https://www.opera.com/terms/crypto"})}}},[t._v(t._s(t.$t("termsOfService.blueboardTermsOfService")))])]},proxy:!0}])})],1)},s=[],o=a(20144),n=o.ZP.extend({name:"TermsOfServiceFooter",props:{textColor:{required:!0,type:String},textSize:{default:"text-xs",required:!1,type:String}}}),i=n,c=a(1001),l=(0,c.Z)(i,r,s,!1,null,null,null),p=l.exports},62463:function(t,e,a){a.r(e),a.d(e,{default:function(){return O}});var r=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"bg-65 bg-blurred-background bg-cover flex flex-col flex-grow h-full justify-between overflow-x-hidden pb-11 pt-16 px-16 z-10"},[e("i18n",{staticClass:"font-bold text-2xl text-left text-white whitespace-pre-line",attrs:{path:"cashback.cashbackOnboarding."+(t.loggedIn?"earnOperaPointsCashback":"earnOperaPointsWallet"),tag:"p"},scopedSlots:t._u([{key:"operaPoints",fn:function(){return[e("span",{staticClass:"text-yellow"},[t._v(" "+t._s(t.$t("general.operaPoints"))+" ")])]},proxy:!0},t.loggedIn?null:{key:"takeYourMoneyBack",fn:function(){return[e("span",{staticClass:"text-yellow"},[t._v(" "+t._s(t.$t("cashback.cashbackOnboarding.takeYourMoneyBack"))+" ")])]},proxy:!0}],null,!0)}),e("div",{staticClass:"flex flex-col text-dark-N77 text-left text-sm"},[e("img",{staticClass:"mb-14 mx-auto w-80",attrs:{alt:"",src:a(82013)}}),t.loggedIn?e("i18n",{attrs:{path:"cashback.cashbackOnboarding.linkTheWalletInfo",tag:"p"},scopedSlots:t._u([{key:"operaTerms",fn:function(){return[e("a",{staticClass:"t-tos-opera_norway-click text-brand-primary",on:{click:function(e){return t.$platform.createNewTab({url:"https://legal.opera.com/terms/"})}}},[t._v(t._s(t.$t("termsOfService.operaTerms")))])]},proxy:!0}],null,!1,849224224)}):e("i18n",{attrs:{path:"cashback.cashbackOnboarding.enableTheWalletInfo",tag:"p"},scopedSlots:t._u([t.LEARN_MORE_ABOUT_OPERA_WALLET_URL?{key:"learnMoreAboutOperaWallet",fn:function(){return[e("a",{staticClass:"t-learn_more_about_wallet-click text-brand-primary",on:{click:function(e){return t.$platform.createNewTab({url:t.LEARN_MORE_ABOUT_OPERA_WALLET_URL})}}},[t._v(t._s(t.$t("general.learnMoreAboutOperaWallet")))])]},proxy:!0}:null],null,!0)}),t.loggedIn?e("a",{staticClass:"flex items-center mt-5 text-brand-primary",on:{click:function(e){return t.$platform.createNewTab({url:t.CASHBACK_ABOUT_OP_URL})}}},[e("img",{staticClass:"inline mr-3 w-3",attrs:{src:a(85048)}}),t._v(" "+t._s(t.$t("cashback.learnAboutOperaPoints"))+" ")]):t._e()],1),e("multi-purpose-popup",{ref:"multiPurposePopup"}),!t.loggedIn||t.operaServiceRequest?e("p",{staticClass:"font-semibold my-2 text-left text-sm text-yellow"},[t._v(" "+t._s(t.$t("cashback.cashbackOnboarding.connectingWalletBenefits",{amount:t.localizePercentage("50")}))+" ")]):t._e(),e("div",{staticClass:"flex flex-col space-y-5"},[e("primary-button",{staticClass:"t-cashback-onboarding_activate",attrs:{color:"yellow-gradient",loading:t.linking,title:t.primaryBtnTitle},on:{click:t.activate}}),e("outlined-button",{staticClass:"flex-1 t-cashback-onboarding_cancel",attrs:{title:t.$t("general.cancel")},on:{click:t.cancel}})],1),t.loggedIn?t._e():e("terms-of-service-footer",{attrs:{"text-color":"text-dark-N77"}})],1)},s=[],o=(a(57658),a(75546)),n=a(61201),i=a(20629),c=a(42514),l=a(13891),p=a(25319),u=a(69790),h=a(93091),d=a(20144),g=a(39624),k=a(10359),b=a(25108);const f={timestamp:0};function _(){let t=!0;return document.body.querySelector('[data-test-handle="profile-dropdown-button"]')||(t=!1),document.body.querySelector('[data-test-handle="country-confirmation-popup"]')&&(t=!1),t}var v=d.ZP.extend({name:"CashbackOnboarding",components:{MultiPurposePopup:c.Z,OutlinedButton:l.Z,PrimaryButton:p.Z,TermsOfServiceFooter:h.Z},beforeRouteEnter(t,e,a){a((t=>{t.$store.getters.loggedIn||t.$store.dispatch("setOnboardingOngoing",!0)}))},beforeRouteLeave(t,e,a){this.$store.dispatch("setOnboardingOngoing",!1),a()},data(){return{CASHBACK_ABOUT_OP_URL:`${g["default"].cashbackOrigin}/opera-points`,LEARN_MORE_ABOUT_OPERA_WALLET_URL:"",linking:!1,request:this.$route.params.request,walletBackups:null}},computed:{...(0,i.Se)({activeOperaServices:"activeOperaServices",activeTabOrigin:"activeTabOrigin",authAborted:"authAborted",isOperaAccountLoggedIn:"isOperaAccountLoggedIn",isOperaServiceActive:"isOperaServiceActive",operaAccountSessionError:"operaAccountSessionError",operaServiceRequest:"operaServiceRequest",operaServicesOrigins:"operaServicesOrigins",operaServicesRequestTypes:"operaServicesRequestTypes"}),loggedIn(){return!!this.$store.getters.loggedIn},popup(){return this.$refs.multiPurposePopup},primaryBtnTitle(){return this.loggedIn?this.$t("cashback.connectWithCashback"):this.walletBackups?.length?this.$t("general.restoreWallet"):this.$t("general.createWallet")}},watch:{activeOperaServices:{deep:!0,handler(t,e){t.operaAccount&&!e.operaAccount&&this.activate()}}},async mounted(){u.Z.sendStatsEvent(u.Z.types.IMPRESSION,this.loggedIn?"op_onboard_wallet_land":"op_onboard_cashback_land"),this.walletBackups=await this.getWalletBackups(),this.isOperaServiceActive(o.SupportedOperaServices.Cashback)?this.$router.back():this.$root.$on("autoActivateCashback",this.activate)},methods:{...(0,i.nv)(["addWalletBackup","cleanWalletData","completeOperaServiceRequest","getAccounts","getWalletBackups","getWalletSeedphraseBackup","informOperaService","linkWalletToCashbackBackend","setAutoActivateNextOperaService","setCashbackActive","stopOperaAccountAuthorization","updateOperaAccount"]),async activate(){if(u.Z.sendStatsEvent(u.Z.types.CLICK,this.loggedIn?"op_onboard_cashback_land_crt":"op_onboard_wallet_land_crt"),!this.isOperaServiceActive(o.SupportedOperaServices.OperaAccount)){if(!this.isOperaAccountLoggedIn)return this.showOperaAccountRequiredPopup();this.showOperaAccountAuthPopup()}if(this.loggedIn){this.linking=!0;try{await this.linkAndActivateCashback(),this.showAckPopup(this.$t("cashback.cashbackHasBeenActivated")),this.stopOperaAccountAuthorization(),this.$nextTick((()=>{"Overview"!==this.$route.name&&this.$router.push({name:"Overview"})}))}catch(t){const e=this.operaAccountSessionError?this.$t("cashback.cashbackConnectError"):t.message??t;this.$popupManager={description:e,popupType:"error",title:this.$t("errors.generic.somethingWentWrongShort"),type:"general"}}finally{this.linking=!1}}else try{if(this.$progress.show(),this.$progress.inflate("low"),this.walletBackups?.length){const t=this.walletBackups[0].evm_address;this.$authenticator.lockAuthenticatorWithPassword();const e=await this.getWalletSeedphraseBackup(t).then((t=>t));await this.$wallet.importWallet({id:"",mnemonic:e}),this.$authenticator.clearSecretAndUnlockAuthenticator()}else await this.$wallet.createNewWallet();if(await this.cleanWalletData(),await this.getAccounts(),await this.linkAndActivateCashback(),u.Z.sendStatsEvent(u.Z.types.CLICK,this.walletBackups?.length?"wt_restore_phr_suc":"wallet_created"),"manual-backup"===this.$route.meta.backupType)return await this.$router.push({name:"BackupRevealWarning"});const t=await this.getWalletBackups();t.length||await this.addWalletBackup(),this.showAckPopup(this.$t("operaAccount.walletHasBeenSetUp")),await this.$router.push({name:"Overview"})}catch(t){if(b.error(t),!this.authAborted){const e=this.operaAccountSessionError?this.$t("cashback.cashbackConnectError"):t.message??t;this.$popupManager={description:e,popupType:"error",title:this.$t("errors.generic.somethingWentWrongShort"),type:"general"},await u.Z.sendStatsEvent(u.Z.types.CLICK,this.walletBackups?.length?"wt_restore_fail_suc":"wt_setpwd_fail",{error:`Error ${this.walletBackups?.length?"restoring":"creating"} wallet`})}this.$authenticator.clearSecretAndUnlockAuthenticator()}finally{this.stopOperaAccountAuthorization(),this.$progress.hide(),u.Z.sendStatsEvent(u.Z.types.IMPRESSION,"op_onboard_cashback_suc")}},async cancel(){u.Z.sendStatsEvent(u.Z.types.CLICK,this.loggedIn?"op_onboard_cashback_land_can":"op_onboard_wallet_land_can"),await this.complete(!1),this.$nextTick((()=>{this.$router.back(),this.loggedIn||window.opr.browserSidebarPrivate?.collapsePanel()}))},async complete(t){const{request:e}=this;if(e)this.completeOperaServiceRequest({request:e,result:t});else{if(!t)return f.timestamp=0,!1;const e=Date.now();f.timestamp=e;const a=this.operaServicesRequestTypes.activationCashback,r=this.operaServicesOrigins["cashback"+((0,n.r8)()?"Test":"")],s=`${r}/accounts/opera/login/`,o=`${r}/*`,i=await this.informOperaService({func:_,informFlare:f,result:t,suggestUrl:s,timestamp:e,type:a,url:o});if(!i)return b.warn("No Informed Tab found."),!1;window.chrome.tabs.update(i.id,{selected:!0})}return!0},async linkAndActivateCashback(){const t=await this.complete(!0);t&&(await this.linkWalletToCashbackBackend(),await this.setCashbackActive())},localizePercentage:k.Z.localizePercentage,showAckPopup(t){this.$popupManager={description:t,title:this.$t("general.youAreAllSet"),type:"ack"}},showOperaAccountAuthPopup(){this.$popupManager={type:"operaAccountAuth"}},showOperaAccountRequiredPopup(){this.popup.show({cancelButtonTitle:this.$t("general.cancel"),confirmButtonTitle:this.$t("general.logIn"),description:this.$t("operaAccount.operaAccountRequiredForCashback"),popupType:"confirm",title:this.$t("operaAccount.operaAuthorization")}),this.popup.$once("popupConfirmed",(()=>{this.setAutoActivateNextOperaService(o.SupportedOperaServices.Cashback),this.showOperaAccountAuthPopup()}))}}}),m=v,w=a(1001),A=(0,w.Z)(m,r,s,!1,null,null,null),O=A.exports},85048:function(t,e,a){t.exports=a.p+"img/external_link_cyan.ca83253e.svg"},82013:function(t,e,a){t.exports=a.p+"img/opera_points.d0f84991.webp"}}]);