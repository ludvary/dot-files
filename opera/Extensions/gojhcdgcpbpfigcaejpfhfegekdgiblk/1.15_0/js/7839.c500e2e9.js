"use strict";(self["webpackChunkdesktop_wallet"]=self["webpackChunkdesktop_wallet"]||[]).push([[7839],{57839:function(t,e,s){s.r(e),s.d(e,{default:function(){return p}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"tracking-wider"},[e("top-bar",{attrs:{"test-parent-name":"send_confirm",title:t.$t("general.confirm")}}),t.transaction?e("div",{staticClass:"px-11 py-4"},[e("div",{staticClass:"border-black border-l border-opacity-10 border-r border-t p-4 rounded-tl-lg rounded-tr-lg"},[e("div",{staticClass:"flex flex-col h-full justify-center"},[e("token-icon",{staticClass:"h-10 my-2 w-10",attrs:{address:t.address,chain:t.chain}}),e("div",{staticClass:"font-bold mt-2 text-2xl"},[t._v(t._s(t.formatNumber(t.amount))+" "+t._s(t.symbol))]),t.fiatAmount?e("div",{staticClass:"mb-1 mt-2 text-lg"},[t._v(" "+t._s("~ "+t.localizeCurrency(t.fiatAmount))+" ")]):t._e(),e("div",{staticClass:"border-b border-dark-N20 my-4 w-full"}),e("div",{staticClass:"flex mb-4 w-full"},[e("div",{staticClass:"flex icon-contacts info-icon items-center my-1 rounded-full text-3xl text-accent"}),e("div",{staticClass:"ms-4 w-full"},[e("div",{staticClass:"font-bold mb-1 text-dark-N77"},[t._v(t._s(t.$t("general.recipient")))]),e("div",{staticClass:"text-normal"},[t._v(" "+t._s(t.recipient)+" ")])])]),e("div",{staticClass:"flex mb-4 w-full"},[e("div",{staticClass:"flex icon-currency info-icon items-center my-1 rounded-full text-3xl text-accent"}),t.transaction&&null!==t.fee?e("div",{staticClass:"ms-4 w-full"},[e("div",{staticClass:"font-bold mb-1 text-dark-N77"},[t._v(t._s(t.$t("general.transactionFee")))]),e("div",{staticClass:"text-sm",class:[{"text-spectrum-red":t.insufficientFunds}]},[t._v(" "+t._s(t.transactionFee)+" ")])]):t._e()]),t.isFeeZero?e("div",{staticClass:"text-spectrum-red"},[t._v(" "+t._s(t.$t("errors.cannotEstimateGas"))+" ")]):t._e(),e("div",{staticClass:"flex hidden w-full"},[e("div",{staticClass:"border border-accent icon-coupon info-icon my-1 p-2 rounded-full text-accent"}),e("div",{staticClass:"ms-4 w-full"},[e("div",{staticClass:"font-bold mb-1 text-dark-N77"},[t._v(t._s(t.$t("general.message")))]),e("div",{staticClass:"text-normal"},[t._v(" "+t._s(t.transaction.message||"-")+" ")])])])],1)]),t._m(0),t.isNativeCurrency?e("div",{staticClass:"flex justify-between p-4 rounded-bl-lg rounded-br-lg text-lg"},[e("div",{staticClass:"font-bold text-dark-N77"},[t._v(t._s(t.$t("general.total")))]),e("div",{staticClass:"text-brand-primary"},[e("span",{staticClass:"font-bold"},[t._v(t._s(t.formatNumber(t.totalAmount))+" "+t._s(t.feeSymbol))]),e("span",[t._v("Â ("+t._s(t.localizeCurrency(t.totalFiatAmount))+")")])])]):t._e(),e("div",{staticClass:"flex-grow"}),e("div",{staticClass:"mt-5"},[t.error?e("div",{staticClass:"flex justify-center my-5 text-center text-sm text-spectrum-red"},[e("img",{staticClass:"mx-2",attrs:{alt:"",src:s(98498)}}),e("span",[t._v(t._s(t.error))])]):t._e(),e("primary-button",{staticClass:"t-send_confirm-send w-full",attrs:{disabled:t.loading||!!t.error,loading:t.loading,title:t.$t("general.send")},on:{click:t.confirmTransaction}})],1)]):t._e()],1)},r=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"-my-2 flex items-center justify-between"},[e("div",{staticClass:"half-circle-left"}),e("div",{staticClass:"border-b border-dark-N20 my-4 w-full"}),e("div",{staticClass:"half-circle-right"})])}],n=(s(57658),s(25319)),a=s(69790),o=s(92266),c=s(69986),l=s(10359),d=s(9502),u=s(37426),m=s(25108),f={name:"SendConfirm",components:{PrimaryButton:n.Z,TokenIcon:o.Z,TopBar:c.Z},props:{token:{default:void 0,type:Object},transaction:{default:void 0,type:Object}},data(){return{error:null,loading:!1,success:!1}},computed:{address(){return this.token.contract.contract},amount(){const t=this.token.contract.decimals;return u.Z.withDecimals(this.transaction.amount,t)},chain(){return this.token.chain},fee(){const t=this.transaction.token,e=u.Z.withDecimals(t.amount,t.decimals);return this.isTransactionFeeCovered(e)||this.$store.dispatch("setTxError","insufficientFunds"),e},feeFiat(){const t=this.$store.getters.getNativePrice(this.chain);return this.fee.multipliedBy(t)},feeSymbol(){return this.transaction.token.symbol},fiatAmount(){const t=this.getPriceForToken(this.token);return this.amount.multipliedBy(t)},insufficientFunds(){return this.$store.getters.txError.insufficientFunds},isFeeZero(){if(null!==this.fee)return this.fee.isEqualTo(0)},isNativeCurrency(){return this.$store.getters.matchingNativeToken(this.token.contract.type,this.chain)},recipient(){return d.Z.elideAddress(this.transaction.to)},symbol(){return this.token?.contract?.symbol},totalAmount(){return this.amount.plus(this.fee)},totalFiatAmount(){return this.fiatAmount.plus(this.feeFiat)},transactionFee(){if(this.transaction)return`~ ${this.formatNumber(this.fee)} ${this.feeSymbol} (${this.localizeCurrency(this.feeFiat)})`},txNetwork(){return this.$store.getters.getTransactionNetwork(this.chain)}},watch:{insufficientFunds(t){t&&(this.error=this.$t("errors.generic.insufficientFunds"))}},beforeDestroy(){this.$store.dispatch("clearTxError")},methods:{async confirmTransaction(){if(!this.error){a.Z.sendStatsEvent(a.Z.types.CLICK,"wt_send_confirm_next"),this.loading=!0,this.$progress.display=!0,this.$progress.done=0;try{const{chain:t}=this,e=await this.$wallet.confirmTransaction(this.transaction.txId),s={chain:t,contract:this.token.contract.contract,from:this.transaction.from,hash:e,time:Date.now(),to:this.transaction.to,type:this.token.contract.type,value:this.transaction.amount};this.$store.dispatch("addPendingTransaction",s),this.success=!0,this.sendDetailedSendTxStats(),this.$router.push({name:"TransactionComplete",params:{token:this.token,txHash:e}})}catch(t){this.$store.getters.authAborted?a.Z.sendStatsEvent(a.Z.types.CLICK,"wt_send_pwd_can"):(this.error=this.getErrorMessage(t),a.Z.sendStatsEvent(a.Z.types.CLICK,"wt_send_pwd_fail"))}this.$progress.display=!1,this.loading=!1}},formatNumber:l.Z.formatNumber,getErrorMessage(t){m.error(t);const e=t.toString()?.toLowerCase(),s=[{message:this.$t("errors.insufficientFunds"),raw:"insufficient funds"}],i=s.find((t=>e.includes(t.raw)))?.message;return i??this.$t("errors.generic.unknownError")},getPriceForToken(t){return t?this.$store.getters.getPriceForToken(t):0},isTransactionFeeCovered(t){const{symbol:e}=this.token.contract,s={amount:this.amount,chain:this.chain,fee:t,symbol:e};return this.$store.getters.isTransactionFeeCovered(s)},localizeCurrency:l.Z.localizeCurrency,sendDetailedSendTxStats(){a.Z.sendStatsEvent(a.Z.types.CLICK,"wt_send_pwd_suc",{amount:this.amount.toString(),coin:this.token.contract.symbol,network:this.txNetwork.name,volumeUSD:this.fiatAmount.toString()})}}},h=f,v=s(1001),C=(0,v.Z)(h,i,r,!1,null,null,null),p=C.exports}}]);