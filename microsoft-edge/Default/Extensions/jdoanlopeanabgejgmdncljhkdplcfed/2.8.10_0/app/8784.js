(globalThis.webpackChunkmomentum=globalThis.webpackChunkmomentum||[]).push([[8784,5711],{58964:(t,e,o)=>{"use strict";o.d(e,{Z:()=>i});let s={};const i={bind:function(t,e){m.utils.isTouchDevice()&&(t.dataset.justBoundMobileBlurHandler=!0,setTimeout((()=>{t.dataset.justBoundMobileBlurHandler=!1}),100),t.dataset.mobileBlurHandlerId=Math.random().toString(36).substring(7),s[t.dataset.mobileBlurHandlerId]=e.value,t.addEventListener("focusout",e.value))},unbind:function(t){m.utils.isTouchDevice()&&(t.removeEventListener("click",s[t.dataset.mobileBlurHandlerId]),delete s[t.dataset.mobileBlurHandlerId],delete t.dataset.mobileBlurHandlerId,delete t.dataset.justBoundMobileBlurHandler)}}},85711:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>v});var s=o(99437),i=o(31624);const a=new(o(64438).Z)("tab.focus.emptySave",.01),n=new(s.Z.extend({name:"FocusDataService",mixins:[i.X],unreactive:()=>({type:"focus",mode:localStorage.getItem("token")?"sync":"cache"}),defaultPath:"focus",methods:{add(t,e){return e.focus?i.X.methods.add.apply(this,arguments):(a.info("Focus data service add with no focus",{userUuid:localStorage.getItem("userId"),stackTrace:m.utils.getStackTrace()}),Promise.reject())}}}));var d=o(2770);const c=s.Z.extend({name:"FocusModel",mixins:[d.Z],data:()=>({id:null,archived:!1,completed:!1,createdDate:m.now(),focus:null,forDate:null,todoId:null,props:["focus","completed","archived","forDate","createdDate","todoId"]}),methods:{updateData(t){d.Z.methods.updateData.call(this,t),this.completed=!!t.completed}}});var r=o(94234),u=o(20144),l=o(40531);const p=new(u.ZP.extend({name:"AutoFocusManager",data:()=>({activeFocus:null,loaded:!1}),computed:{autoFocusEnabled:()=>l.ax.autoFocus&&m.conditionalFeatures.featureEnabled("pinfocus")},watch:{autoFocusEnabled:{handler(t){t?this.getTopTodo().then((t=>this.activeFocus=this.createFocusFromTodo(t))):this.activeFocus=null},immediate:!0},"activeFocus.focus"(t){this.activeFocus&&m.trigger("todo:set:title",this.activeFocus.todoId,t)}},created(){m.on("todo:globalChange",this.onTodoChange),m.on("todo:loadingStateChange",this.onLoadingStateChange),m.on("todo:activeListLoaded",this.setLoaded),this.getInitialLoadedState()},destroyed(){m.off("todo:globalChange",this.onTodoChange),m.off("todo:loadingStateChange",this.onLoadingStateChange),m.off("todo:activeListLoaded",this.setLoaded)},methods:{getInitialLoadedState(){return m.widgetManager.getWidgetAsync("todo").then((t=>{var e,o;"Done"===(null===(e=t.manager.activeProvider.selectedList())||void 0===e||null===(o=e.itemCollection)||void 0===o?void 0:o.listStatus)&&(this.loaded=!0)}))},setLoaded(){this.loaded=!0},toggleComplete(){this.activeFocus&&(this.activeFocus.completed=!this.activeFocus.completed,m.trigger("todo:set:done",this.activeFocus.todoId,this.activeFocus.completed))},onLoadingStateChange(){this.autoFocusEnabled&&this.getTopTodo().then((t=>{var e;!t||this.activeFocus&&(t.get("id")||t.id)===this.activeFocus.todoId?t||null!==(e=this.activeFocus)&&void 0!==e&&e.completed||(this.activeFocus=null):this.activeFocus=this.createFocusFromTodo(t)}))},getTopTodo:()=>m.widgetManager.getWidgetAsync("todo").then((t=>t.getTopTodo())),onTodoChange(...t){var e,o,s;const i=t[0];if(t.find((t=>t&&(t.ignoreRender||t.silent)))||!this.autoFocusEnabled||null==i||!i.changed||!Object.keys(i.changed).length||!1===(null===(e=i.changed)||void 0===e?void 0:e.isLoading))return;const a=(null===(o=i.changed)||void 0===o?void 0:o.completedDate)||(null===(s=i.changed)||void 0===s?void 0:s.modifiedServer);this.getTopTodo().then((t=>{var e,o;t?this.activeFocus=this.createFocusFromTodo(t):null!==(e=this.activeFocus)&&void 0!==e&&e.todoId&&(i.get("id")||i.id).includes(null===(o=this.activeFocus)||void 0===o?void 0:o.todoId)&&(this.activeFocus.completed=i.get("done"),a||(this.activeFocus=null))}))},createFocusFromTodo(t){if(!t)return null;let e=new c;return e.updateData({focus:t.get("title"),archived:!1,completed:t.get("done"),createdDate:m.now(),id:m.utils.uuidv4(),todoId:t.get("id")||t.id,forDate:m.utils.getDateString()}),e}}}));var h=o(20338);const v=new(s.Z.extend({name:"FocusCollection",mixins:[r.FZ,r.mX],unreactive:()=>({type:"focus",Model:c,dataService:n,newModel:null,analytics:new h.Z({feature:"focus"})}),computed:{emptyFocus(){return!this.activeFocus.focus},activeFocusInCollection(){const t=m.utils.getDateString(),e=Object.values(this.data.items).filter((e=>!e.archived&&e.forDate===t)).sort(((t,e)=>e.createdDate-t.createdDate));return e.length?e[0]:null},activeFocus(){return p.activeFocus||this.activeFocusInCollection||this.newModel},loaded(){return(!p.autoFocusEnabled||p.loaded)&&this.data.loaded}},created(){this.instantiateNewModel(),m.on("focus:pin",this.onFocusPin),m.on("todo:globalChange",this.onTodoChange),m.on("newDay",this.archiveAll)},destroyed(){m.off("focus:pin",this.onFocusPin),m.off("todo:globalChange",this.onTodoChange),m.off("newDay",this.archiveAll)},methods:{instantiateNewModel(){this.newModel=new this.Model,this.newModel.copyProperties()},async save(){const t=this.emptyFocus;p.activeFocus||this.activeFocus.editProps.focus&&await this[this.emptyFocus?"add":"update"](this.activeFocus),t&&this.instantiateNewModel(),this.analytics.capture("focus "+(t?"add":"edit"),{position:localStorage.getItem("pomodoro-showing")?"pomodoro":"default"}),this.activeFocus.commitChanges(),this.activeFocus.todoId&&m.trigger("todo:set:title",this.activeFocus.todoId,this.activeFocus.focus)},archive(){this.analytics.capture("focus clear",{completed:this.activeFocus.completed}),p.activeFocus?l.ax.autoFocus=!1:r.FZ.methods.archive.call(this,this.activeFocus)},archiveAll(){Object.values(this.data.items).forEach((t=>this.archive(t)))},toggleComplete(){const t=this.activeFocus.completed;this.analytics.capture("focus "+(t?"uncomplete":"complete"),Object.assign({position:localStorage.getItem("pomodoro-showing")?"pomodoro":"default"},t?{}:{autofocus:p.autoFocusEnabled})),p.activeFocus?p.toggleComplete():(this.activeFocus.completed=!t,this.dataService.update(this.activeFocus.id,{completed:!t}).then((()=>{this.activeFocus.todoId&&m.trigger("todo:set:done",this.activeFocus.todoId,!t)})).catch((e=>{throw this.activeFocus.completed=t,e})))},onFocusPin(t){l.ax.autoFocus=!1;let e=p.createFocusFromTodo(t);e&&e.focus&&(e.copyProperties(),this.add(e))},onTodoChange(...t){var e,o;const s=t[0];if(t.find((t=>t&&(t.ignoreRender||t.silent)))||!this.activeFocus||!Object.keys(this.data.items).length||null==s||!s.changed)return;let i=Object.values(this.data.items).find((t=>{var e;return t.todoId&&t.todoId===((null===(e=s.get)||void 0===e?void 0:e.call(s,"id"))||(null==s?void 0:s.id))}));if(!i)return;if(null!==(e=t[0])&&void 0!==e&&null!==(o=e.changed)&&void 0!==o&&o.deleted)return void this.archive();const a=s.get("done"),n=s.get("title");i.completed===a&&i.focus===n||(i.completed=a,i.focus=n,this.dataService.update(i.id,{completed:a,focus:n}))}}}))},30827:(t,e,o)=>{"use strict";o.d(e,{Z:()=>i});var s=o(99437);const i=m.showAnyway=new(s.Z.extend({name:"ShowAnyway",data:()=>({widgets:[]}),methods:{show(t){this.includes(t)||this.widgets.push(t)},hide(t){const e=this.widgets.indexOf(t);~e&&this.widgets.splice(e,1)},includes(t){return this.widgets.includes(t)}}}))},52358:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>p});var s=o(8081),i=o.n(s),a=o(23645),n=o.n(a),d=o(61667),c=o.n(d),r=new URL(o(40167),o.b),u=n()(i()),l=c()(r);u.push([t.id,"\n/* stylelint-disable */\n/* Using em units for font sizing for focus because it needs to scale down for responsive more than the other regions */\nh3[data-v-39996f61] { margin: 0; padding: 0;\n}\n.focuses[data-v-39996f61] { width: 100%; position: relative; display: flex; flex-direction: column; gap: 0.5rem; align-items: center; vertical-align: top;\n}\n.focuses[data-v-39996f61]::before { height: 450px; width: 100%; max-width: 800px; position: absolute; top: 50%; left: 50%; z-index: -1; background: url("+l+') no-repeat 50% 60%; background-size: contain; content: " "; transform: translate3d(-50%, -50%, 0); transition: opacity 0.2s;\n}\n.pomodoro .focuses[data-v-39996f61]:before { display: none;\n}\n.focus-wrapper[data-v-39996f61] { display: grid; align-items: end; justify-content: center; justify-items: center;\n}\n.focus-inner-wrapper[data-v-39996f61], .focus-prompt-wrapper[data-v-39996f61] { grid-area: 1 / 1 / 2 / 2;\n}\n.focus-wrapper .greeting[data-v-39996f61] { width: 100%; position: relative; display: inline-block !important; overflow: visible;\n}\n.prompt[data-v-39996f61] { --input-padding: 4px 2px 1px; max-width: 87.5vw;\n}\n[data-v-39996f61] .focus-question { margin: 0; font-size: 2.1875em; font-weight: 400; line-height: normal;\n}\n[data-v-39996f61] .focus-input, .prompt .hidden-data[data-v-39996f61] { width: 100%; padding: var(--input-padding); display: block; background: 0; border: 0; border-bottom: 2px solid #fff; -webkit-border-radius: 0; color: #fff; font-size: 2.25em; font-weight: 500; line-height: 1.2; outline: none; text-align: center; transition: border-color .2s ease; /* -webkit-border-radius: removes curves on iOS */\n}\n[data-v-39996f61] .focus-input::placeholder { color: #fff;\n}\n.prompt .hidden-data[data-v-39996f61] { height: 0; padding-top: 0; padding-bottom: 0; display: block; border: none; border-bottom: none; transition: none; visibility: hidden;\n}\n.focus-prompt-wrapper[data-v-39996f61] { width: 100%;\n}\n.focus-prompt-wrapper[data-v-39996f61] .three-col-layout--center { display: flex; flex-direction: column; align-items: center;\n}\n.team-focus-wrapper[data-v-39996f61] { position: relative;\n}\n@media screen and (max-width: 450px) {\n.focuses[data-v-39996f61] {\n}\n.focuses[data-v-39996f61]:before { display: none;\n}\n.focus-wrapper[data-v-39996f61] { padding-bottom: 6px;\n}\n.prompt[data-v-39996f61] { padding-bottom: 0;\n}\n[data-v-39996f61] .focus-question { margin-bottom: 4px !important; font-size: 20px !important;\n} /* Ensure we deep select to target both the actual question and the placeholder one in FocusContent */\n[data-v-39996f61] .focus-input { margin-bottom: -2px; font-size: 24px !important;\n}\n[data-v-39996f61] .button { --v-padding: 7px; font-size: 0.875rem;\n}\n.team-focus .side-col[data-v-39996f61] { flex-basis: 0;\n}\n}\n',""]);const p=u},61667:t=>{"use strict";t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]|(%20)/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t):t}},28247:(t,e,o)=>{"use strict";o.r(e),o.d(e,{default:()=>h});var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"focuses app-container",class:{"show-anyway":t.showAnyway.includes("focus")},attrs:{"data-test":"focus","data-show-anyway":"focus"}},[t.inPomodoro&&t.collectionReady?e("div",{staticClass:"focus-wrapper has-dash-icon pomodoro-view",attrs:{"data-ob":"focus-dash"}},[t.editing?e("div",{staticClass:"prompt"},[e("span",{staticClass:"hidden-data"},[t._v(t._s(t.activeFocus.editProps.focus??""))]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.activeFocus.editProps.focus,expression:"activeFocus.editProps.focus",modifiers:{trim:!0}},{name:"mobile-blur",rawName:"v-mobile-blur",value:t.save,expression:"save"}],ref:"prompt",staticClass:"focus-input",attrs:{type:"text",placeholder:t.inputPlaceholder,"data-test":"focus-input",autocomplete:"off"},domProps:{value:t.activeFocus.editProps.focus},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.save.apply(null,arguments)},blur:[t.stopEditing,function(e){return t.$forceUpdate()}],input:function(e){e.target.composing||t.$set(t.activeFocus.editProps,"focus",e.target.value.trim())}}})]):e("span",{staticClass:"greeting"},[e("transition",{attrs:{name:"fade",mode:"out-in"}},[t.emptyFocus?e("div",{key:"2"},[e("pomodoro-empty-focus",{attrs:{message:t.pomodoroMessage},on:{"add-focus":t.showPomodoroFocusInput}})],1):e("div",{key:"1",staticClass:"focus"},[e("focus-content",{attrs:{focus:t.activeFocus,"in-pomodoro":!0},on:{complete:t.completeFocus,archive:t.archiveFocus,edit:t.editCurrentFocus,new:t.archiveFocusAndShowPomodoroFocusInput}})],1)])],1)]):t.collectionReady?e("div",{staticClass:"focus-wrapper has-dash-icon clock-view",attrs:{"data-ob":"focus-dash"}},[e("div",{directives:[{name:"visible",rawName:"v-visible.transition.delay",value:!t.editing&&!t.emptyFocus,expression:"!editing && !emptyFocus",modifiers:{transition:!0,delay:!0}}],staticClass:"focus-inner-wrapper"},[e("div",{staticClass:"focus"},[e("focus-content",{attrs:{focus:t.activeFocus},on:{complete:t.completeFocus,archive:t.archiveFocus,edit:t.editCurrentFocus,new:t.archiveFocus},scopedSlots:t._u([{key:"nav",fn:function(){return[t._t("nav")]},proxy:!0}],null,!0)})],1)]),t._v(" "),e("three-col-layout",{directives:[{name:"visible",rawName:"v-visible.transition.delay",value:t.editing||t.emptyFocus,expression:"editing || emptyFocus",modifiers:{transition:!0,delay:!0}}],staticClass:"focus-prompt-wrapper",scopedSlots:t._u([{key:"left",fn:function(){return[t._t("nav")]},proxy:!0},{key:"center",fn:function(){return[e("div",{staticClass:"prompt"},[e("h3",{staticClass:"focus-question"},[t._v("What is your main focus for today?")]),t._v(" "),e("span",{staticClass:"hidden-data"},[t._v(t._s(t.activeFocus.editProps.focus??""))]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.activeFocus.editProps.focus,expression:"activeFocus.editProps.focus",modifiers:{trim:!0}},{name:"mobile-blur",rawName:"v-mobile-blur",value:t.save,expression:"save"}],ref:"prompt",staticClass:"focus-input",attrs:{type:"text","data-test":"focus-input",autocomplete:"off"},domProps:{value:t.activeFocus.editProps.focus},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.save.apply(null,arguments)},input:function(e){e.target.composing||t.$set(t.activeFocus.editProps,"focus",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])]},proxy:!0}],null,!0)})],1):t._e(),t._v(" "),t.inPomodoro?t._e():[e("transition",{attrs:{name:"fade",mode:"out-in"}},[t.teamFocusEnabled?e("div",{staticClass:"team-focus-wrapper"},[e("team-focus")],1):t._e()])]],2)};s._withStripped=!0;var i=o(85711),a=o(58964),n=o(30827),d=o(2039),c=o(96138),r=o(42223);const u=(t,e)=>{t.style.opacity=e?"1":"0",t.style.pointerEvents=e?"":"none",t.style.visibility=e?"visible":"hidden"},l={bind:(t,{value:e})=>{u(t,e)},componentUpdated:(t,{value:e,oldValue:o,modifiers:s})=>{!e!=!o&&(s.transition&&(t.style.transition="opacity 0.5s ease, visibility 0.5s ease"),s.delay&&(t.style.transitionDelay=e?"0.5s":"0"),u(t,e))}},p={name:"Focus",components:{FocusContent:()=>o.e(2225).then(o.bind(o,2225)),PomodoroEmptyFocus:()=>o.e(2010).then(o.bind(o,82010)),TeamFocus:()=>o.e(8128).then(o.bind(o,38128)),ThreeColLayout:c.Z},directives:{MobileBlur:a.Z,Visible:l},mixins:[r.Z],props:{inPomodoro:{type:Boolean,default:!1},inputPlaceholder:{type:String,default:""},pomodoroMessage:{type:String,default:"Focus"}},data:()=>({editing:!1}),computed:{teamFocusEnabled(){return m.conditionalFeatures.featureEnabled("team_focus")&&!this.$touch},activeFocus:()=>i.default.activeFocus,collectionReady:()=>i.default.loaded,emptyFocus:()=>i.default.emptyFocus},unreactive:()=>({showAnyway:n.Z,centerBelowMetadata:d.Z}),created(){m.on("focus:pomodoro:new",this.showPomodoroFocusInput),m.on("globalEvent:esc",this.stopEditing)},destroyed(){m.off("focus:pomodoro:new",this.showPomodoroFocusInput),m.off("globalEvent:esc",this.stopEditing)},methods:{editCurrentFocus(){this.editing=!0,this.activeFocus.copyProperties(),this.focusOnPrompt()},archiveFocus(){i.default.archive()},completeFocus(){i.default.toggleComplete(),this.activeFocus.completed&&this.congratulate()},congratulate(){const t=["Great work!","Good job!","Nice.","Way to go!"];this.$e.$emit("flashMessage",{message:t[Math.floor(Math.random()*t.length)]})},save(){var t;this.emptyFocus&&(this.activeFocus.editProps.forDate=m.utils.getDateString()),null===(t=this.$refs.prompt)||void 0===t||t.blur(),i.default.save().then((()=>this.editing=!1)).catch(console.error)},stopEditing(){this.editing=!1},focusOnPrompt(){this.$nextTick((()=>{var t;null===(t=this.$refs.prompt)||void 0===t||t.focus()}))},showPomodoroFocusInput(){this.editing=!0,this.focusOnPrompt()},archiveFocusAndShowPomodoroFocusInput(){this.archiveFocus(),this.showPomodoroFocusInput()}}};o(43499);const h=(0,o(51900).Z)(p,s,[],!1,null,"39996f61",null).exports},43499:(t,e,o)=>{var s=o(52358);s.__esModule&&(s=s.default),"string"==typeof s&&(s=[[t.id,s,""]]),s.locals&&(t.exports=s.locals),(0,o(45346).Z)("b8902a0a",s,!1,{ssrId:!0})},40167:(t,e,o)=>{"use strict";t.exports=o.p+"4db99af162d6759d96bd.png"}}]);